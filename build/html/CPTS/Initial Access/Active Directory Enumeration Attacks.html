

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Active Directory Enumeration Attacks &mdash; Celestial Security Reference R1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f9ffe49" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=3b1ff954"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/dark_mode_js/default_dark.js?v=fd565c74"></script>
      <script src="../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Certified Defensive Security Analyst" href="../../CDSA/Certified%20Defensive%20Security%20Analyst.html" />
    <link rel="prev" title="Pivoting-Tunneling and Port Forwarding" href="../Lateral%20Movement/Pivoting-Tunneling%20and%20Port%20Forwarding.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Celestial Security Reference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Hack the Box Certifications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Certified%20Penetration%20Tester.html">Certified Penetration Tester</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CDSA/Certified%20Defensive%20Security%20Analyst.html">Certified Defensive Security Analyst</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Offensive Methods</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OFSEC/recon/Active%20Scanning.html">Active Scanning</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Overview/Introduction%20to%20Active%20Directory.html">Introduction to Active Directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview/Penetration%20Testing%20Overview.html">Penetration Testing Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview/Types%20of%20Penetration%20testing.html">Types of Penetration testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview/Vulnerability%20Assessment.html">Vulnerability Assessment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reconnaissance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Penetration%20Testing%20Overview.html">Penetration Testing Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Network%20Enumeration%20with%20nmap.html">Network Enumeration with nmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Footprinting.html">Footprinting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Infrastructure%20Enumeration.html">Infrastructure Based Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Infrastructure%20Enumeration.html#domain-information">Domain information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Infrastructure%20Enumeration.html#cloud-resource-enumeration">Cloud Resource Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Infrastructure%20Enumeration.html#online-tools-to-gather-information-about-a-domain">Online Tools to gather information about a domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Infrastructure%20Enumeration.html#staff">Staff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Host%20Enumeration.html">Host Based Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/fingerprinting.html">fingerprinting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Initial%20Enumeration%20of%20a%20AD%20Domain.html">Initial Enumeration of a AD Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/External%20Recon%20and%20Enumeration%20Principles.html">External Recon and Enumeration Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconnaissance/Information%20Gathering.html">Information Gathering</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Initial Access</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="File%20Inclusion.html">File Inclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSH%20Forwarding.html">SSH Forwarding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamic%20Port%20Forwarding%20with%20SSH%20and%20SOCKS%20Tunneling.html">Dynamic Port Forwarding with SSH and SOCKS Tunneling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Remote-Reverse%20Port%20Forwarding%20with%20SSH.html">Remote-Reverse Port Forwarding with SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Meterpreter%20Tunneling%20and%20Port%20Forwarding.html">Meterpreter Tunneling and Port Forwarding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Socat%20Redirection%20with%20a%20Reverse%20Shell.html">Socat Redirection with a Reverse Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="Socat%20Redirection%20with%20a%20Bind%20Shell.html">Socat Redirection with a Bind Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSH%20for%20Windows%3A%20plink.exe.html">SSH for Windows: plink.exe</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSH%20Pivoting%20with%20Sshuttle.html">SSH Pivoting with Sshuttle</a></li>
<li class="toctree-l1"><a class="reference internal" href="Web%20Server%20Pivoting%20with%20Rpivot.html">Web Server Pivoting with Rpivot</a></li>
<li class="toctree-l1"><a class="reference internal" href="Port%20Forwarding%20with%20Windows%20Netsh.html">Port Forwarding with Windows Netsh</a></li>
<li class="toctree-l1"><a class="reference internal" href="DNS%20Tunneling%20with%20Dnscat2.html">DNS Tunneling with Dnscat2</a></li>
<li class="toctree-l1"><a class="reference internal" href="SOCKS5%20Tunneling%20with%20Chisel.html">SOCKS5 Tunneling with Chisel</a></li>
<li class="toctree-l1"><a class="reference internal" href="ICMP%20Tunneling%20with%20SOCKS.html">ICMP Tunneling with SOCKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="RDP%20and%20SOCKS%20Tunneling%20with%20SocksOverRDP.html">RDP and SOCKS Tunneling with SocksOverRDP</a></li>
<li class="toctree-l1"><a class="reference internal" href="LLMNR%20NBT-NS%20Poisoning%20from%20Linux.html">LLMNR/NBT-NS Poisoning - from Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="Password%20Attacks.html">Password Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Remote%20Password%20Attacks.html">Remote Password Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Using%20the%20Metasploit%20Framework.html">Using the Metasploit Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Shells%20and%20Payloads.html">Shells and Payloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="Attacking%20Common%20Services.html">Attacking Common Services</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Active Directory Enumeration Attacks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-recon-and-enumeration-principles"><span class="xref std std-ref">External Recon and Enumeration Principles</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#initial-enumeration-of-a-ad-domain"><span class="xref std std-ref">Initial Enumeration of a AD Domain</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#llmnr-nbt-ns-poisoning-from-linux"><span class="xref std std-ref">LLMNR/NBT-NS Poisoning - from Linux</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#llmnr-nbt-ns-poisoning-from-windows"><span class="xref std std-ref">LLMNR/NBT-NS Poisoning - from Windows</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tools-of-the-trade">Tools of the trade</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stories-from-the-field">Stories from the field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scenario-1-waiting-on-an-admin">Scenario 1: Waiting on An Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scenario-2-spraying-the-night-away">Scenario 2: Spraying the night away</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scenario-3-fighting-in-the-dark">Scenario 3: Fighting in the Dark</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lateral Movement</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/File%20Transfers.html">File Transfers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Changing%20the%20user-agent%20to%20avoid%20detection.html">Changing the user-agent to avoid detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Native%20File%20Transfer%20Powershell.html">Native File Transfer Powershell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Creating%20a%20secure%20upload%20server%20using%20Nginx.html">Creating a secure upload server using Nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Hunting%20for%20Files.html">Hunting for Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Linux%20Pass%20the%20Ticket.html">Linux Pass the Ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Lateral%20Movement/Pivoting-Tunneling%20and%20Port%20Forwarding.html">Pivoting-Tunneling and Port Forwarding</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Active%20Directory.html">Active Directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Active%20Directory%20Explorer.html">Active Directory Explorer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ADRecon.html">ADRecon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ADRecon.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ADRecon.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/adidnsdump.html">adidnsdump</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/apache%20nutch.html">apache nutch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Application%20Testing.html">Application Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Attacking%20AD%20and%20NTDS.dit.html">Attacking AD and NTDS.dit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Attacking%20LSASS.html">Attacking LSASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Attacking%20the%20SAM.html">Attacking the SAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Base64.html">Base64</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Bash.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/bettercap.html">bettercap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Bitlocker.html">Bitlocker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Black%20box%20Testing.html">Black box Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/bloodhound.html">bloodhound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/bloodhound.py.html">bloodhound.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/builtwith.html">builtwith</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/burp%20suite.html">burp suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Certificates.html">Certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/cewl.html">cewl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/chisel.html">chisel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Compliance%20Standards.html">Compliance Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Compliance%20Standards.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/crackmapexec.html">crackmapexec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/crawling.html">crawling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/crowbar.html">crowbar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/crunch.html">crunch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/cupp.html">cupp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/CVE-2021-1675.py.html">CVE-2021-1675.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/CVSS.html">CVSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/d3ad0ne.html">d3ad0ne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/DKIM.html">DKIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/domainPasswordSpray.html">domainPasswordSpray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/DMARC.html">DMARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/DNS.html">DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/dnsenum.html">dnsenum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/dnsrecon.html">dnsrecon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/dnsx.html">dnsx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ettercap.html">ettercap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/enum4linux-ng.html">enum4linux-ng</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Evasive%20testing.html">Evasive Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/evil-winrm.html">evil-winrm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/extent.html">extent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/GetNPUsers.py.html">GetNPUsers.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/fail2ban.html">fail2ban</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ffuf.html">ffuf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/fierce.html">fierce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/File%20Encryption%20on%20Linux.html">File Encryption on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/File%20Encryption%20Windows.html">File Encryption Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/finalRecon.html">finalRecon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Firefox%20Decrypt.html">Firefox Decrypt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/FTP.html">FTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/gettgtpkinit.py.html">gettgtpkinit.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/getnthash.py.html">getnthash.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/getuserspns.py.html">getuserspns.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/git.html">git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/gobuster.html">gobuster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/gpp-decrypt.html">gpp-decrypt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Grey%20Box%20Testing.html">Grey Box Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Group3r.html">Group3r</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/hashcat.html">hashcat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/hippa.html">hippa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Hybrid%20evasive.html">Hybrid evasive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/hydra.html">hydra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/IMAP-POP3.html">IMAP-POP3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/impacket.html">impacket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/IPMP.html">IPMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/iso-27001.html">iso-27001</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/inveigh.html">inveigh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/invoke-TheHash.html">Invoke-TheHash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/john.html">john</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/keytab.html">keytab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/keytabextract.py.html">keytabextract.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/kwprocessor.html">kwprocessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ldapsearch.html">ldapsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/lazagne.html">lazagne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/laps.html">laps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/LAPSToolkit.html">LAPSToolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/linkatz.html">Linikatz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Linux%20local%20password%20attacks.html">Linux local password attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Linux%20Mount.html">Linux Mount</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/lookupsid.py.html">lookupsid.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/kerbrute.html">kerbrute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/md5sum.html">md5sum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/metasploit.html">metasploit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/medusa.html">medusa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Microsoft%20DREAD.html">Microsoft DREAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/mimikatz.html">mimikatz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/mitm6.html">mitm6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/msfvenom.html">msfvenom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/MSSQL.html">MSSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/MySQL.html">MySQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/mssqlclient.py.html">mssqlclient.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/nessus.html">nessus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/netcat.html">netcat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/netcraft.html">netcraft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/net-webclient.html">net-webclient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Network%20Testing.html">Network Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/NIST.html">NIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/NFS.html">NFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/nikto.html">nikto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/nmap.html">nmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/nopac.py.html">nopac.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/netstat.html">netstat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/netstat.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Non-evasive%20testing.html">Non-evasive testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/O365spray.html">O365spray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/openssl.html">openssl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Oracle%20TNS.html">Oracle TNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/OSINT%20Framework.html">OSINT Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/OSSTMM.html">OSSTMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/OWASP.html">OWASP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/owasp-zap.html">owasp-zap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/pentest.html">pentest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/petitpotam.py.html">petitpotam.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/pci-dss.html">pci-dss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Physical%20Testing.html">Physical Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/PingCastle.html">PingCastle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/powershell.html">powershell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/powerview.html">powerview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/PowerShell%20Web%20Uploads.html">PowerShell Web Uploads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/princeprocessor.html">princeprocessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/proxychains.html">proxychains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/psexec.html">psexec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/psexec.py.html">psexec.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/PTES.html">PTES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/pyenv.html">pyenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/raiseChild.py.html">raiseChild.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/r-services.html">r-services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rdp.html">rdp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/recon-ng.html">recon-ng</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/reconSpider.html">reconSpider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/responder.html">responder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rpc.html">rpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rsync.html">rsync</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rsync.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rsync.html#footprinting">Footprinting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rsync.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rpcclient.html">rpcclient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rpcinfo.html">rpcinfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rcpdump.py.html">rcpdump.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/rubeus.html">rubeus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/S3%20Buckets.html">S3 Buckets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/shadow%20credentials%20abusing.html">shadow credentials abusing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sharpHound.html">sharpHound</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sharpview.html">sharpview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smb.html">smb</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smbserver.py.html">smbserver.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/scrappy.html">scrappy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sc.exe.html">sc.exe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sc.exe.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sc.exe.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/secretsdump.py.html">secretsdump.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/setspn.exe.html">setspn.exe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/shells.html">shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smbmap.html">smbmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/SMTP.html">SMTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smtp-user-enum.html">smtp-user-enum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smtp-user-enum.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smtp-user-enum.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/smtp-user-enum.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/SNMP.html">SNMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/SQL%20Injection.html">SQL Injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/snaffler.html">snaffler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Social%20Engineering%20Testing.html">Social Engineering Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ssh.html">ssh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/spf.html">spf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/spiderfoot.html">spiderfoot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/SQL%20Injection%20Types.html">SQL Injection Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/SQL%20Load%20file.html">SQL Load file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sqlcmd.html">sqlcmd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sqsh.html">sqsh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/subbrute.html">subbrute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/sudo.html">sudo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/subfinder.html">subfinder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Subverting%20SQL%20Query%20Logic.html">Subverting SQL Query Logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Symmetrical%20Encryption.html">Symmetrical Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/targetedKerberoast.py.html">targetedKerberoast.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/theharvester.html">theharvester</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ticketer.py.html">ticketer.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Transfer%20with%20Code.html">Transfer with Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Transferring%20File%20with%20GfxDownloadWrapper.exe.html">Transferring File with GfxDownloadWrapper.exe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/tscon.exe.html">tscon.exe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/ufw.html">ufw</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Python%20Uploadserver.html">Python Uploadserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Using%20Bitsadmin%20to%20send%20and%20receive%20files.html">Using Bitsadmin to send and receive files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Using%20Certutil%20to%20download.html">Using Certutil to download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Using%20OpenSSL%20to%20send%20and%20receive%20files.html">Using OpenSSL to send and receive files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Understanding%20User%20Privileges.html">Understanding User Privileges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Virtual%20Hosts.html">Virtual Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/WAF.html">WAF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/wafw00f.html">wafw00f</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/wappalyzer.html">wappalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/web%20shells.html">web shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Webdav.html">Webdav</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/wget.html">wget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/whatweb.html">whatweb</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/White%20Box%20Testing.html">White Box Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/whois.html">whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/windapsearch.html">windapsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20CMD.html">Windows CMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20Lateral%20Movement.html">Windows Lateral Movement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20Local%20Password%20Attacks.html">Windows Local Password Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20Pass%20The%20Hash.html">Windows Pass The Hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20Pass%20The%20Ticket.html">Windows Pass The Ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/Windows%20Passwords.html">Windows Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/winrm.html">winrm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/WMI.html">WMI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/wmiexec.py.html">wmiexec.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/wpscan.html">wpscan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/xfreerdp.html">xfreerdp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tags/xxd.html">xxd</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Celestial Security Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Certified%20Penetration%20Tester.html">Certified Penetration Tester</a></li>
      <li class="breadcrumb-item active">Active Directory Enumeration Attacks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/CPTS/Initial Access/Active Directory Enumeration Attacks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="active-directory-enumeration-attacks">
<h1>Active Directory Enumeration Attacks<a class="headerlink" href="#active-directory-enumeration-attacks" title="Link to this heading"></a></h1>
<p>Date: 2024-12-19 12:54:04</p>
<p>Status: #in-progress</p>
<p>Tags: <a class="reference internal" href="../Certified%20Penetration%20Tester.html#certified-penetration-tester"><span class="std std-ref">Certified Penetration Tester</span></a></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Active directory came out in 2000 with the release of Windows Server 2000.  Active Directory (AD) is based
on the x.500 protocol.  AD provides structures for:</p>
<ul class="simple">
<li><p>Users</p></li>
<li><p>Groups</p></li>
<li><p>Network Devices</p></li>
<li><p>File shares</p></li>
<li><p>Policies</p></li>
<li><p>devices and trusts</p></li>
</ul>
<p>AD provides authentication, accounting and authorization within a Windows enterprise.</p>
<p>See more on AD in the module:  <a class="reference internal" href="../Overview/Introduction%20to%20Active%20Directory.html#introduction-to-active-directory"><span class="std std-ref">Introduction to Active Directory</span></a></p>
</section>
<section id="external-recon-and-enumeration-principles">
<h2><a class="reference internal" href="../Reconnaissance/External%20Recon%20and%20Enumeration%20Principles.html#external-recon-and-enumeration-principles"><span class="std std-ref">External Recon and Enumeration Principles</span></a><a class="headerlink" href="#external-recon-and-enumeration-principles" title="Link to this heading"></a></h2>
</section>
<section id="initial-enumeration-of-a-ad-domain">
<h2><a class="reference internal" href="../Reconnaissance/Initial%20Enumeration%20of%20a%20AD%20Domain.html#initial-enumeration-of-a-ad-domain"><span class="std std-ref">Initial Enumeration of a AD Domain</span></a><a class="headerlink" href="#initial-enumeration-of-a-ad-domain" title="Link to this heading"></a></h2>
</section>
<section id="llmnr-nbt-ns-poisoning-from-linux">
<h2><a class="reference internal" href="LLMNR%20NBT-NS%20Poisoning%20from%20Linux.html#llmnr-nbt-ns-poisoning-from-linux"><span class="std std-ref">LLMNR/NBT-NS Poisoning - from Linux</span></a><a class="headerlink" href="#llmnr-nbt-ns-poisoning-from-linux" title="Link to this heading"></a></h2>
</section>
<section id="llmnr-nbt-ns-poisoning-from-windows">
<h2><span class="xref std std-ref">LLMNR/NBT-NS Poisoning - from Windows</span><a class="headerlink" href="#llmnr-nbt-ns-poisoning-from-windows" title="Link to this heading"></a></h2>
</section>
<section id="tools-of-the-trade">
<h2>Tools of the trade<a class="headerlink" href="#tools-of-the-trade" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../tags/powerview.html#powerview"><span class="std std-ref">powerview</span></a> A PowerShell tool and a .NET port of the same used to gain situational awareness in AD. These tools can be used as replacements for various Windows net* commands and more. PowerView and SharpView can help us gather much of the data that BloodHound does, but it requires more work to make meaningful relationships among all of the data points. These tools are great for checking what additional access we may have with a new set of credentials, targeting specific users or computers, or finding some “quick wins” such as users that can be attacked via Kerberoasting or ASREPRoasting.</p></li>
<li><p><a class="reference internal" href="../../tags/sharpview.html#sharpview"><span class="std std-ref">sharpview</span></a> see above</p></li>
<li><p><a class="reference internal" href="../../tags/sharpHound.html#sharphound"><span class="std std-ref">sharpHound</span></a> The C# data collector to gather information from Active Directory about varying AD objects such as users, groups, computers, ACLs, GPOs, user and computer attributes, user sessions, and more. The tool produces JSON files which can then be ingested into the BloodHound GUI tool for analysis.</p></li>
<li><p><a class="reference internal" href="../../tags/bloodhound.py.html#bloodhound-py"><span class="std std-ref">bloodhound.py</span></a> Used to visually map out AD relationships and help plan attack paths that may otherwise go unnoticed. Uses the SharpHound PowerShell or C# ingestor to gather data to later be imported into the BloodHound JavaScript (Electron) application with a Neo4j database for graphical analysis of the AD environment.</p></li>
<li><p><a class="reference internal" href="../Reconnaissance/Initial%20Enumeration%20of%20a%20AD%20Domain.html#kerberute"><span class="std std-ref">Kerberute</span></a> A tool written in Go that uses Kerberos Pre-Authentication to enumerate Active Directory accounts, perform password spraying, and brute-forcing.</p></li>
<li><p><a class="reference internal" href="../../tags/impacket.html#impacket"><span class="std std-ref">impacket</span></a>       A collection of tools written in Python for interacting with network protocols. The suite of tools contains various scripts for enumerating and attacking Active Directory.</p></li>
<li><p><a class="reference internal" href="../../tags/responder.html#responder"><span class="std std-ref">responder</span></a> Responder is a purpose-built tool to poison LLMNR, NBT-NS, and MDNS, with many different functions.</p></li>
<li><p><a class="reference internal" href="../../tags/inveigh.html#inveigh"><span class="std std-ref">inveigh</span></a> Similar to Responder, a PowerShell tool for performing various network spoofing and poisoning attacks.</p></li>
<li><p><a class="reference internal" href="../../tags/rpcinfo.html#rpcinfo"><span class="std std-ref">rpcinfo</span></a> The rpcinfo utility is used to query the status of an RPC program or enumerate the list of available RPC services on a remote host. The “-p” option is used to specify the target host. For example the command “rpcinfo -p 10.0.0.1” will return a list of all the RPC services available on the remote host, along with their program number, version number, and protocol. Note that this command must be run with sufficient privileges.</p></li>
<li><p><a class="reference internal" href="../../tags/crackmapexec.html#crackmapexec"><span class="std std-ref">crackmapexec</span></a> CME is an enumeration, attack, and post-exploitation toolkit which can help us greatly in enumeration and performing attacks with the data we gather. CME attempts to “live off the land” and abuse built-in AD features and protocols like SMB, WMI, WinRM, and MSSQL.</p></li>
<li><p><a class="reference internal" href="../../tags/rubeus.html#rubeus"><span class="std std-ref">rubeus</span></a> Rubeus is a C# tool built for Kerberos Abuse.</p></li>
<li><p><a class="reference internal" href="../../tags/rpcclient.html#rpcclient"><span class="std std-ref">rpcclient</span></a> A part of the Samba suite on Linux distributions that can be used to perform a variety of Active Directory enumeration tasks via the remote RPC service.</p></li>
<li><p><a class="reference internal" href="../../tags/getuserspns.py.html#getuserspns-py"><span class="std std-ref">getuserspns.py</span></a>  Another Impacket module geared towards finding Service Principal names tied to normal users.</p></li>
<li><p><a class="reference internal" href="../../tags/hashcat.html#hashcat"><span class="std std-ref">hashcat</span></a> A great hash cracking and password recovery tool.</p></li>
<li><p><a class="reference internal" href="../../tags/enum4linux-ng.html#enum4linux-ng"><span class="std std-ref">enum4linux-ng</span></a> A rework of the original Enum4linux tool that works a bit differently.</p></li>
<li><p><a class="reference internal" href="../../tags/ldapsearch.html#ldapsearch"><span class="std std-ref">ldapsearch</span></a> Built-in interface for interacting with the LDAP protocol.</p></li>
<li><p><a class="reference internal" href="../../tags/windapsearch.html#windapsearch"><span class="std std-ref">windapsearch</span></a> A Python script used to enumerate AD users, groups, and computers using LDAP queries. Useful for automating custom LDAP queries.</p></li>
<li><p><a class="reference internal" href="../../tags/domainPasswordSpray.html#domainpasswordspray"><span class="std std-ref">domainPasswordSpray</span></a> DomainPasswordSpray is a tool written in PowerShell to perform a password spray attack against users of a domain.</p></li>
<li><p><a class="reference internal" href="../../tags/LAPSToolkit.html#lapstoolkit"><span class="std std-ref">LAPSToolkit</span></a> The toolkit includes functions written in PowerShell that leverage PowerView to audit and attack Active Directory environments that have deployed Microsoft’s Local Administrator Password Solution (LAPS).</p></li>
<li><p><a class="reference internal" href="../../tags/smbmap.html#smbmap"><span class="std std-ref">smbmap</span></a> SMB share enumeration across a domain.</p></li>
<li><p><a class="reference internal" href="../../tags/psexec.py.html#psexec-py"><span class="std std-ref">psexec.py</span></a> Part of the Impacket toolkit, it provides us with Psexec-like functionality in the form of a semi-interactive shell.</p></li>
<li><p><a class="reference internal" href="../../tags/wmiexec.py.html#wmiexec-py"><span class="std std-ref">wmiexec.py</span></a> Part of the Impacket toolkit, it provides the capability of command execution over WMI</p></li>
<li><p><a class="reference internal" href="../../tags/snaffler.html#snaffler"><span class="std std-ref">snaffler</span></a> Useful for finding information (such as credentials) in Active Directory on computers with accessible file shares.</p></li>
<li><p><a class="reference internal" href="../../tags/smbserver.py.html#smbserver-py"><span class="std std-ref">smbserver.py</span></a> Simple SMB server execution for interaction with Windows hosts. Easy way to transfer files within a network.</p></li>
<li><p><a class="reference internal" href="../../tags/setspn.exe.html#setspn-exe"><span class="std std-ref">setspn.exe</span></a> Adds, reads, modifies and deletes the Service Principal Names (SPN) directory property for an Active Directory service account.</p></li>
<li><p><a class="reference internal" href="../../tags/mimikatz.html#mimikatz"><span class="std std-ref">mimikatz</span></a> Performs many functions. Notably, pass-the-hash attacks, extracting plaintext passwords, and Kerberos ticket extraction from memory on a host.</p></li>
<li><p><a class="reference internal" href="../../tags/secretsdump.py.html#secretsdump-py"><span class="std std-ref">secretsdump.py</span></a> Remotely dump SAM and LSA secrets from a host.</p></li>
<li><p><a class="reference internal" href="../../tags/evil-winrm.html#evil-winrm"><span class="std std-ref">evil-winrm</span></a> Provides us with an interactive shell on a host over the WinRM protocol.</p></li>
<li><p><a class="reference internal" href="../../tags/mssqlclient.py.html#mssqlclient-py"><span class="std std-ref">mssqlclient.py</span></a> art of the Impacket toolkit, it provides the ability to interact with MSSQL databases.</p></li>
<li><p><a class="reference internal" href="../../tags/nopac.py.html#nopac-py"><span class="std std-ref">nopac.py</span></a> Exploit combo using CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user.</p></li>
<li><p><a class="reference internal" href="../../tags/rcpdump.py.html#rcpdump-py"><span class="std std-ref">rcpdump.py</span></a> Part of the Impacket toolset, RPC endpoint mapper.</p></li>
<li><p><a class="reference internal" href="../../tags/CVE-2021-1675.py.html#cve-2021-1675-py"><span class="std std-ref">CVE-2021-1675.py</span></a> Printnightmare PoC in python.</p></li>
<li><p><a class="reference internal" href="../../tags/impacket.html#impacket-ntlmrelayx"><span class="std std-ref">impacket-ntlmrelayx</span></a> Part of the Impacket toolset, it performs SMB relay attacks.</p></li>
<li><p><a class="reference internal" href="../../tags/petitpotam.py.html#petitpotam-py"><span class="std std-ref">petitpotam.py</span></a> PoC tool for CVE-2021-36942 to coerce Windows hosts to authenticate to other machines via MS-EFSRPC EfsRpcOpenFileRaw or other functions.</p></li>
<li><p><a class="reference internal" href="../../tags/gettgtpkinit.py.html#gettgtpkinit-py"><span class="std std-ref">gettgtpkinit.py</span></a> Tool for manipulating certificates and TGTs.</p></li>
<li><p><a class="reference internal" href="../../tags/getnthash.py.html#getnthash-py"><span class="std std-ref">getnthash.py</span></a> This tool will use an existing TGT to request a PAC for the current user using U2U.</p></li>
<li><p><a class="reference internal" href="../../tags/adidnsdump.html#adidnsdump"><span class="std std-ref">adidnsdump</span></a> A tool for enumerating and dumping DNS records from a domain. Similar to performing a DNS Zone transfer.</p></li>
<li><p><a class="reference internal" href="../../tags/gpp-decrypt.html#gpp-decrypt"><span class="std std-ref">gpp-decrypt</span></a> Extracts usernames and passwords from Group Policy preferences files.</p></li>
<li><p><a class="reference internal" href="../../tags/GetNPUsers.py.html#getnpusers-py"><span class="std std-ref">GetNPUsers.py</span></a> Part of the Impacket toolkit. Used to perform the ASREPRoasting attack to list and obtain AS-REP hashes for users with the ‘Do not require Kerberos preauthentication’ set. These hashes are then fed into a tool such as Hashcat for attempts at offline password cracking.</p></li>
<li><p><a class="reference internal" href="../../tags/lookupsid.py.html#lookupsid-py"><span class="std std-ref">lookupsid.py</span></a> SID bruteforcing tool.c</p></li>
<li><p><a class="reference internal" href="../../tags/ticketer.py.html#ticketer-py"><span class="std std-ref">ticketer.py</span></a> A tool for creation and customization of TGT/TGS tickets. It can be used for Golden Ticket creation, child to parent trust attacks, etc.</p></li>
<li><p><a class="reference internal" href="../../tags/raiseChild.py.html#raisechild-py"><span class="std std-ref">raiseChild.py</span></a> Part of the Impacket toolkit, It is a tool for automated child to parent domain privilege escalation.</p></li>
<li><p><a class="reference internal" href="../../tags/Active%20Directory%20Explorer.html#active-directory-explorer"><span class="std std-ref">Active Directory Explorer</span></a> Active Directory Explorer (AD Explorer) is an AD viewer and editor. It can be used to navigate an AD database and view object properties and attributes. It can also be used to save a snapshot of an AD database for offline analysis. When an AD snapshot is loaded, it can be explored as a live version of the database. It can also be used to compare two AD database snapshots to see changes in objects, attributes, and security permissions.</p></li>
<li><p><a class="reference internal" href="../../tags/PingCastle.html#pingcastle"><span class="std std-ref">PingCastle</span></a> Used for auditing the security level of an AD environment based on a risk assessment and maturity framework (based on CMMI adapted to AD security).</p></li>
<li><p><a class="reference internal" href="../../tags/Group3r.html#group3r"><span class="std std-ref">Group3r</span></a> Group3r is useful for auditing and finding security misconfigurations in AD Group Policy Objects (GPO).</p></li>
<li><p><a class="reference internal" href="../../tags/ADRecon.html#adrecon"><span class="std std-ref">ADRecon</span></a> A tool used to extract various data from a target AD environment. The data can be output in Microsoft Excel format with summary views and analysis to assist with analysis and paint a picture of the environment’s overall security state.</p></li>
</ul>
</section>
<section id="stories-from-the-field">
<h2>Stories from the field<a class="headerlink" href="#stories-from-the-field" title="Link to this heading"></a></h2>
<section id="scenario-1-waiting-on-an-admin">
<h3>Scenario 1: Waiting on An Admin<a class="headerlink" href="#scenario-1-waiting-on-an-admin" title="Link to this heading"></a></h3>
<p>During this engagement, I compromised a single host and gained SYSTEM level access. Because this was a domain-joined host, I was able to use this access to enumerate the domain. I went through all of the standard enumeration, but did not find much. There were Service Principal Names (SPNs) present within the environment, and I was able to perform a Kerberoasting attack and retrieve TGS tickets for a few accounts. I attempted to crack these with <a class="reference internal" href="../../tags/hashcat.html#hashcat"><span class="std std-ref">hashcat</span></a> and some of my standard wordlists and rules, but was unsuccessful at first. I ended up leaving a cracking job running overnight with a very large wordlist combined with the <a class="reference internal" href="../../tags/d3ad0ne.html#d3ad0ne"><span class="std std-ref">d3ad0ne</span></a> rule that ships with <a class="reference internal" href="../../tags/hashcat.html#hashcat"><span class="std std-ref">hashcat</span></a>. The next morning I had a hit on one ticket and retrieved the cleartext password for a user account. This account did not give me significant access, but it did give me write access on certain file shares. I used this access to drop SCF files around the shares and left Responder going. After a while, I got a single hit, the NetNTLMv2 hash of a user. I checked through the BloodHound output and noticed that this user was actually a domain admin! Easy day from here.</p>
</section>
<section id="scenario-2-spraying-the-night-away">
<h3>Scenario 2: Spraying the night away<a class="headerlink" href="#scenario-2-spraying-the-night-away" title="Link to this heading"></a></h3>
<p>Password spraying can be an extremely effective way to gain a foothold in a domain, but we must exercise great care not to lock out user accounts in the process. On one engagement, I found an SMB NULL session using the <a class="reference internal" href="../../tags/enum4linux-ng.html#enum4linux-ng"><span class="std std-ref">enum4linux-ng</span></a> tool and retrieved both a listing of all users from the domain, and the domain password policy. Knowing the password policy was crucial because I could ensure that I was staying within the parameters to not lock out any accounts and also knew that the policy was a minimum eight-character password and password complexity was enforced (meaning that a user’s password required 3/4 of special character, number, uppercase, or lower case number, i.e., Welcome1). I tried several common weak passwords such as Welcome1, Password1, Password123, Spring2018, etc. but did not get any hits. Finally, I made an attempt with <a class="reference external" href="mailto:Spring&#37;&#52;&#48;18">Spring<span>&#64;</span>18</a> and got a hit! Using this account, I ran <a class="reference internal" href="../../tags/bloodhound.html#bloodhound"><span class="std std-ref">bloodhound</span></a> and found several hosts where this user had local admin access. I noticed that a domain admin account had an active session on one of these hosts. I was able to use the Rubeus tool and extract the Kerberos TGT ticket for this domain user. From there, I was able to perform a pass-the-ticket attack and authenticate as this domain admin user. As a bonus, I was able to take over the trusting domain as well because the Domain Administrators group for the domain that I took over was a part of the Administrators group in the trusting domain via nested group membership, meaning I could use the same set of credentials to authenticate to the other domain with full administrative level access.</p>
</section>
<section id="scenario-3-fighting-in-the-dark">
<h3>Scenario 3: Fighting in the Dark<a class="headerlink" href="#scenario-3-fighting-in-the-dark" title="Link to this heading"></a></h3>
<p>I had tried all of my standard ways to obtain a foothold on this third engagement, and nothing had worked. I decided that I would use the <a class="reference internal" href="../../tags/kerbrute.html#kerbrute"><span class="std std-ref">kerbrute</span></a> tool to attempt to enumerate valid usernames and then, if I found any, attempt a targeted password spraying attack since I did not know the password policy and did not want to lock any accounts out. I used the linkedin2username tool (<a class="reference external" href="https://github.com/initstring/linkedin2username">https://github.com/initstring/linkedin2username</a>) to first mashup potential usernames from the company’s LinkedIn page. I combined this list with several username lists from the statistically-likely-usernames GitHub repo (<a class="reference external" href="https://github.com/insidetrust/statistically-likely-usernames">https://github.com/insidetrust/statistically-likely-usernames</a>) and, after using the userenum feature of <a class="reference internal" href="../../tags/kerbrute.html#kerbrute"><span class="std std-ref">kerbrute</span></a>, ended up with 516 valid users. I knew I had to tread carefully with password spraying, so I tried with the password Welcome2021 and got a single hit! Using this account, I ran the Python version of BloodHound from my attack host and found that all domain users had RDP access to a single box. I logged into this host and used the PowerShell tool DomainPasswordSpray to spray again. I was more confident this time around because I could a) view the password policy and b) the DomainPasswordSpray tool will remove accounts close to lockout from the target list. Being that I was authenticated within the domain, I could now spray with all domain users, which gave me significantly more targets. I tried again with the common password Fall2021 and got several hits, all for users not in my initial wordlist. I checked the rights for each of these accounts and found that one was in the Help Desk group, which had GenericAll rights over the Enterprise Key Admins group (<a class="reference external" href="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#genericall">https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#genericall</a>). The Enterprise Key Admins group had GenericAll privileges over a domain controller, so I added the account I controlled to this group, authenticated again, and inherited these privileges. Using these rights, I performed the <a class="reference internal" href="../../tags/shadow%20credentials%20abusing.html#shadow-credentials-abusing"><span class="std std-ref">shadow credentials abusing</span></a> attack and retrieved the NT hash for the domain controller machine account. With this NT hash, I was then able to perform a DCSync attack and retrieve the NTLM password hashes for all users in the domain because a domain controller can perform replication, which is required for DCSync.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Lateral%20Movement/Pivoting-Tunneling%20and%20Port%20Forwarding.html" class="btn btn-neutral float-left" title="Pivoting-Tunneling and Port Forwarding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../CDSA/Certified%20Defensive%20Security%20Analyst.html" class="btn btn-neutral float-right" title="Certified Defensive Security Analyst" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, CelestialTech.ca.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>